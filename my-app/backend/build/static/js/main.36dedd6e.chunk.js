(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{137:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(94),a=n.n(c),s=n(22),i=n(13),o=n(3),u=n(5),l=n(11),j=n(2),b=n(31),d={message:null,error:!1},O=Object(b.b)({name:"notification",initialState:d,reducers:{showError:function(e,t){return{message:t.payload,error:!0}},showSuccess:function(e,t){return{message:t.payload,error:!1}},hide:function(e,t){return d}}}),p=O.actions,f=p.showError,h=p.showSuccess,x=p.hide,v=null,m=function(e,t,n){return function(){var r=Object(l.a)(Object(u.a)().mark((function r(c){return Object(u.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:v&&clearTimeout(v),c(n?f(e):h(e)),v=setTimeout((function(){c(x())}),1e3*t);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},g=function(e,t){return function(n){n(m(e,t,!0))}},y=function(e,t){return function(n){n(m(e,t,!1))}},w=O.reducer,k=n(38),B=n.n(k),S="/api/blogs",C=null,T=function(){var e=Object(l.a)(Object(u.a)().mark((function e(){var t;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get(S);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:C}},e.next=3,B.a.post(S,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(Object(u.a)().mark((function e(t,n){var r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.put("".concat(S,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n,r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:C}},e.next=3,B.a.delete("".concat(S,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A={getAll:T,create:U,update:L,setToken:function(e){C="bearer ".concat(e)},remove:N},R=["id","user"],E=["id","user"],H=Object(b.b)({name:"blogs",initialState:[],reducers:{likeBlog:function(e,t){var n=t.payload.id;return e.map((function(e){return e.id===n?e=Object(j.a)(Object(j.a)({},e),{},{likes:t.payload.likes}):e}))},setBlogs:function(e,t){return t.payload},appendBlog:function(e,t){return e.concat(t.payload)},removeBlog:function(e,t){return e.filter((function(e){return e.id!==t.payload}))},commentBlog:function(e,t){var n=t.payload.id;return e.map((function(e){return e.id===n?e=Object(j.a)(Object(j.a)({},e),{},{comments:t.payload.comments}):e}))}}}),I=H.actions,z=I.commentBlog,F=I.likeBlog,D=I.setBlogs,J=I.appendBlog,G=I.removeBlog,V=H.reducer,W=function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q={login:W},K=n(84),M=Object(b.b)({name:"user",initialState:null,reducers:{setUser:function(e,t){return t.payload},unsetUser:function(e,t){return null}}}),P=M.actions,Q=P.setUser,X=P.unsetUser,Y=M.reducer,Z="/api/users",$=function(){var e=Object(l.a)(Object(u.a)().mark((function e(){var t;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get(Z);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("".concat(Z,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee={getAll:$,get:_},te=Object(b.b)({name:"users",initialState:[],reducers:{setUsers:function(e,t){return t.payload},appendUser:function(e,t){return e.concat(t.payload)}}}),ne=te.actions,re=ne.setUsers,ce=(ne.appendUser,te.reducer),ae=n(8),se=n(6),ie=function(e,t){var n=Object(r.useState)(""),c=Object(se.a)(n,2),a=c[0],s=c[1];return{type:t,value:a,id:"".concat(e,"-input"),reset:function(){s("")},onChange:function(e){s(e.target.value)}}},oe=n(147),ue=n(142),le=n(97),je=n(1),be=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(!1),c=Object(se.a)(n,2),a=c[0],s=c[1],i=function(){return s(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),Object(je.jsxs)(le.a,{show:a,onHide:i,placement:e.placement,children:[Object(je.jsx)(le.a.Header,{closeButton:!0,children:Object(je.jsx)(le.a.Title,{children:e.titleText})}),Object(je.jsx)(le.a.Body,{children:e.children})]})}));be.displayName="Togglable";var de=be,Oe=["reset"],pe=["reset"],fe=["reset"],he=Object(r.forwardRef)((function(e,t){var n=Object(i.b)(),r=Object(i.c)((function(e){return e.user})),c=r.id,a=r.name,s=r.username,b=ie("title","text"),d=b.reset,O=Object(o.a)(b,Oe),p=ie("author","text"),f=p.reset,h=Object(o.a)(p,pe),x=ie("url","text"),v=x.reset,m=Object(o.a)(x,fe),w=function(){d(),f(),v()},k={marginBottom:5};return Object(je.jsx)(de,{placement:"end",titleText:"Add a new blog",ref:t,children:Object(je.jsx)("div",{className:"formDiv",children:Object(je.jsx)(oe.a,{onSubmit:function(t){var r;t.preventDefault(),n((r={title:O.value,author:h.value,url:m.value,user:{id:c,name:a,username:s}},function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.create(Object(j.a)(Object(j.a)({},r),{},{likes:0}));case 3:n=e.sent,t(J(Object(j.a)(Object(j.a)({},n),{},{user:r.user}))),t(y("a new blog ".concat(r.title," by ").concat(r.author," created"),5)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t(g("adding failed: ".concat(e.t0.response.data.error),5));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),e.toggleForm(),w()},children:Object(je.jsxs)(oe.a.Group,{children:[Object(je.jsx)("div",{style:k,children:Object(je.jsx)(oe.a.Control,Object(j.a)({placeholder:"title here"},O))}),Object(je.jsx)("div",{style:k,children:Object(je.jsx)(oe.a.Control,Object(j.a)({placeholder:"author here"},h))}),Object(je.jsx)("div",{style:k,children:Object(je.jsx)(oe.a.Control,Object(j.a)({placeholder:"url here"},m))}),Object(je.jsx)(ue.a,{variant:"success",id:"create-button",type:"submit",children:"add"})]})})})})}));he.displayName="BlogForm";var xe=he,ve=n(14),me=n(150),ge=function(e){var t=e.toggleForm,n=Object(ae.m)(),r=Object(i.c)((function(e){return e.blogs})),c=Object(ve.a)(r).sort((function(e,t){return t.likes-e.likes}));return Object(je.jsxs)("div",{children:[Object(je.jsxs)("h4",{children:["blogs ",Object(je.jsx)(ue.a,{variant:"success",onClick:t,children:"add new"})]}),Object(je.jsx)(me.a,{children:c.map((function(e){var t=e.id,r=e.author,c=e.title;return Object(je.jsxs)(me.a.Item,{action:!0,onClick:function(){return n("/blogs/".concat(t))},children:[c," by ",r]},t)}))})]})},ye=function(){var e=Object(r.useRef)(),t=function(){e.current.toggleVisibility()};return Object(je.jsxs)("div",{children:[Object(je.jsx)(xe,{toggleForm:t,ref:e}),Object(je.jsx)(ge,{toggleForm:t})]})},we=n(148),ke=n(149),Be=function(){var e=Object(i.c)((function(e){return e.user})).name,t=Object(i.b)(),n={padding:10};return Object(je.jsx)("div",{style:n,children:Object(je.jsxs)(we.a,{collapseOnSelect:!0,expand:"sm",bg:"light",children:[Object(je.jsx)(we.a.Brand,{children:Object(je.jsx)("strong",{style:{fontSize:30,marginLeft:10},children:"Blogapp"})}),Object(je.jsx)(we.a.Toggle,{style:{marginRight:10},"aria-controls":"responsive-navbar-nav"}),Object(je.jsx)(we.a.Collapse,{id:"responsive-navbar-nav",children:Object(je.jsxs)(ke.a,{style:n,className:"m-auto",children:[Object(je.jsx)(ke.a.Link,{href:"#",as:"span",children:Object(je.jsx)(s.b,{to:"/",children:"Blogs"})}),Object(je.jsx)(ke.a.Link,{href:"#",as:"span",children:Object(je.jsx)(s.b,{to:"/users",children:"Users"})}),Object(je.jsxs)(ke.a.Link,{href:"#",as:"span",children:[Object(je.jsxs)("em",{children:[e," logged in "]}),Object(je.jsx)(ue.a,{size:"sm",variant:"secondary",id:"logout-button",onClick:function(){return t((function(e){window.localStorage.removeItem("loggedBloglistUser"),A.setToken(null),e(X()),e(y("logged out",5))}))},children:"logout"})]})]})})]})})},Se=n(143),Ce=function(){var e=Object(i.c)((function(e){return e.notification})),t=e.message,n=e.error;return null===t?null:Object(je.jsx)("div",{className:"message",children:Object(je.jsx)(Se.a,{variant:n?"danger":"success",children:t})})},Te=["reset"],Ue=["reset"],Le=function(){var e=Object(i.b)(),t=ie("username","text"),n=(t.reset,Object(o.a)(t,Te)),r=ie("password","password"),c=(r.reset,Object(o.a)(r,Ue));return Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{children:Object(je.jsx)("h2",{children:"Login"})}),Object(je.jsx)(oe.a,{onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(){var n=Object(l.a)(Object(u.a)().mark((function n(r){var c;return Object(u.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,q.login({username:e,password:t});case 3:c=n.sent,A.setToken(c.token),c.id=Object(K.a)(c.token).id,window.localStorage.setItem("loggedBloglistUser",JSON.stringify(c)),r(Q(c)),r(y("welcome, ".concat(e,"!"),5)),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),r(g("".concat(n.t0.response.data.error),5));case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(n.value,c.value))},children:Object(je.jsxs)(oe.a.Group,{children:[Object(je.jsx)(oe.a.Label,{children:"username:"}),Object(je.jsx)(oe.a.Control,Object(j.a)({},n)),Object(je.jsx)(oe.a.Label,{children:"password:"}),Object(je.jsx)(oe.a.Control,Object(j.a)({},c)),Object(je.jsx)(ue.a,{style:{marginTop:5},variant:"primary",id:"login-button",type:"submit",children:"login"})]})})]})},Ne=function(e){var t=e.user;return t?Object(je.jsxs)("div",{children:[Object(je.jsx)("h2",{children:t.name}),Object(je.jsx)("h5",{children:"added blogs"}),Object(je.jsx)("div",{children:t.blogs.map((function(e){return Object(je.jsx)("div",{children:Object(je.jsx)(s.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))})]}):null},Ae=n(144),Re=function(){var e=Object(i.c)((function(e){return e.users}));return Object(je.jsx)("div",{children:Object(je.jsx)(Ae.a,{striped:!0,children:Object(je.jsxs)("tbody",{children:[Object(je.jsxs)("tr",{children:[Object(je.jsx)("th",{children:Object(je.jsx)("strong",{children:"username"})}),Object(je.jsx)("th",{children:Object(je.jsx)("strong",{children:"blogs created"})})]}),e.map((function(e){return Object(je.jsxs)("tr",{children:[Object(je.jsx)("td",{children:Object(je.jsx)(s.b,{to:"/users/".concat(e.id),children:e.username})}),Object(je.jsx)("td",{children:e.blogs.length})]},e.id)}))]})})})},Ee=n(145),He=n(98),Ie=n(146),ze=["reset"],Fe=function(e){var t=e.commentHandler,n=ie("comment","text"),c=n.reset,a=Object(o.a)(n,ze),s=Object(r.useState)(!1),i=Object(se.a)(s,2),u=i[0],l=i[1],b=Object(je.jsxs)(He.a,{id:"popover-basic",children:[Object(je.jsx)(He.a.Header,{as:"h3",children:"Be nice :)"}),Object(je.jsx)(He.a.Body,{children:Object(je.jsxs)(oe.a,{onSubmit:function(e){e.preventDefault(),t(a.value),c(),l(!u)},children:[Object(je.jsx)(oe.a.Group,{children:Object(je.jsx)(oe.a.Control,Object(j.a)({},a))}),Object(je.jsx)(ue.a,{style:{marginTop:5},type:"submit",children:"add"})]})})]});return Object(je.jsx)(Ie.a,{show:u,placement:"right",overlay:b,children:Object(je.jsx)(ue.a,{variant:"success",onClick:function(){return l(!u)},children:"Leave a comment"})})},De=function(e){var t=e.blog,n=Object(ae.m)(),r=Object(i.c)((function(e){return e.user})),c=Object(i.b)();if(!t)return null;var a=t.id,b=t.title,d=t.author,O=t.url,p=t.user,f=t.likes,h=t.comments;return Object(je.jsxs)("div",{children:[Object(je.jsxs)("h3",{children:[Object(je.jsxs)("span",{style:{marginRight:10},children:[b," by ",d]}),Object(je.jsxs)(ue.a,{onClick:function(){var e;c((e=t,function(){var t=Object(l.a)(Object(u.a)().mark((function t(n){var r,c,a;return Object(u.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.id,e.user,c=Object(o.a)(e,R),t.next=4,A.update(r,Object(j.a)(Object(j.a)({},c),{},{likes:c.likes+1}));case 4:a=t.sent,n(F(a)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(g("liking failed: ".concat(t.t0.response.data.error),5));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()))},size:"sm",children:["Likes ",Object(je.jsx)(Ee.a,{bg:"secondary",children:f})]})]}),Object(je.jsx)("div",{children:Object(je.jsx)("a",{href:"//".concat(O),children:O})}),Object(je.jsxs)("div",{children:["added by ",Object(je.jsx)(s.b,{to:"/users/".concat(p.id),children:p.name})]}),Object(je.jsx)("div",{children:p.id===r.id?Object(je.jsx)(ue.a,{variant:"warning",id:"remove-button",onClick:function(){window.confirm("Remove ".concat(b," by ").concat(d,"?"))&&(c(function(e){return function(){var t=Object(l.a)(Object(u.a)().mark((function t(n){return Object(u.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A.remove(e);case 3:n(G(e)),n(y("blog removed",5)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(g("removing failed: ".concat(t.t0.response.data.error),5));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(a)),n("/"))},children:"remove"}):null}),Object(je.jsxs)("div",{style:{marginTop:20},children:[Object(je.jsx)(Fe,{commentHandler:function(e){c(function(e,t){return function(){var n=Object(l.a)(Object(u.a)().mark((function n(r){var c,a,s;return Object(u.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c=e.id,e.user,a=Object(o.a)(e,E),n.next=4,A.update(c,Object(j.a)(Object(j.a)({},a),{},{comments:a.comments.concat(t)}));case 4:s=n.sent,r(z(s)),r(y("comment added",5)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),r(g("commenting failed: ".concat(n.t0.response.data.error),5));case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()}(t,e))}}),Object(je.jsxs)("div",{style:{marginTop:20},children:[Object(je.jsx)("h5",{children:"Comments"}),Object(je.jsx)("ul",{children:h.map((function(e,t){return Object(je.jsx)("li",{children:e},t)}))})]})]})]})},Je=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.user})),n=Object(i.c)((function(e){return e.users})),c=Object(i.c)((function(e){return e.blogs}));Object(r.useEffect)((function(){e(function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getAll();case 2:n=e.sent,t(D(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(r.useEffect)((function(){e((function(e){var t=window.localStorage.getItem("loggedBloglistUser");if(t){var n=JSON.parse(t);A.setToken(n.token),n.id=Object(K.a)(n.token).id,e(Q(n))}}))}),[]),Object(r.useEffect)((function(){e(function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.getAll();case 2:n=e.sent,t(re(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[c]);var a=Object(ae.k)("/users/:id"),s=a?n.find((function(e){return e.id===a.params.id})):null,o=Object(ae.k)("/blogs/:id"),j=o?c.find((function(e){return e.id===o.params.id})):null;return Object(je.jsx)("div",{className:"container",style:{maxWidth:1080},children:null===t?Object(je.jsxs)("div",{children:[Object(je.jsx)(Ce,{}),Object(je.jsx)(Le,{})]}):Object(je.jsxs)("div",{children:[Object(je.jsx)(Be,{}),Object(je.jsxs)("div",{style:{padding:"3%"},children:[Object(je.jsx)(Ce,{}),Object(je.jsxs)(ae.c,{children:[Object(je.jsx)(ae.a,{path:"/",element:Object(je.jsx)(ye,{})}),Object(je.jsx)(ae.a,{path:"/users",element:Object(je.jsx)(Re,{})}),Object(je.jsx)(ae.a,{path:"/users/:id",element:Object(je.jsx)(Ne,{user:s})}),Object(je.jsx)(ae.a,{path:"/blogs/:id",element:Object(je.jsx)(De,{blog:j})})]})]})]})})},Ge=Object(b.a)({reducer:{blogs:V,notification:w,user:Y,users:ce}});a.a.createRoot(document.getElementById("root")).render(Object(je.jsx)(i.a,{store:Ge,children:Object(je.jsx)(s.a,{children:Object(je.jsx)(Je,{})})}))}},[[137,1,2]]]);
//# sourceMappingURL=main.36dedd6e.chunk.js.map